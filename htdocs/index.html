<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>allergenfreedog — Compare Dog Foods</title>
  <meta name="description" content="Compare dog foods by ingredients. Spot allergens and overlaps." />
  <style>
    :root{
      --bg:#fbf6ef;
      --ink:#274642;
      --muted:#5a7d75;
      --primary:#79C99E;
      --accent:#FF9F68;
      --card:#ffffff;
      --ok:#85d1a0;
      --warn:#ffd27a;
      --danger:#ffb0a3;
      --ring:0 0 0 3px rgb(121 201 158 / .35);
      --shadow:0 10px 24px rgba(0,0,0,.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif}
    .container{max-width:1100px;margin-inline:auto;padding:24px}
    header{position:sticky;top:0;background:var(--bg)/.8;backdrop-filter:blur(8px);border-bottom:1px solid #e9e1d7;z-index:5}
    .nav{display:flex;align-items:center;gap:16px;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800;font-size:1.25rem;color:var(--ink)}
    .brand svg{width:28px;height:28px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;margin:18px 0}
    .field{display:grid;gap:8px;margin:10px 0}
    input[type=text], textarea{width:100%;padding:12px 14px;border:2px solid #e3e8e4;border-radius:12px;background:white;color:var(--ink);outline:none}
    input:focus, textarea:focus{border-color:var(--primary);box-shadow:var(--ring)}
    .btn{appearance:none;border:0;border-radius:999px;padding:10px 16px;font-weight:700;cursor:pointer;transition:.2s;display:inline-flex;gap:8px;align-items:center}
    .btn.primary{background:var(--accent);color:#fff}
    .btn.ghost{background:transparent;border:2px solid #c6dacd;color:var(--muted)}
    .btn.primary:hover{transform:translateY(-1px);filter:saturate(1.1)}
    .btn.ghost:hover{border-color:var(--primary);color:var(--ink)}
    .tag{color:var(--accent);font-weight:800}
    .lede{color:var(--muted);max-width:60ch}
    .columns{display:grid;grid-template-columns:1fr 1fr;gap:24px}
    @media(max-width:680px){.columns{grid-template-columns:1fr}}
    ul{padding-left:20px}
    .pill{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:4px 10px;font-size:.8rem;font-weight:700}
    .pill.ok{background:var(--ok)}
    .pill.warn{background:var(--warn)}
    .pill.danger{background:var(--danger)}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand" aria-label="allergenfreedog brand">
        <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M20 20c0-4 3-7 7-7s7 3 7 7-3 7-7 7-7-3-7-7Z" fill="#79C99E"/><circle cx="48" cy="20" r="6" fill="#79C99E"/><circle cx="17" cy="36" r="5" fill="#79C99E"/><circle cx="35" cy="43" r="5" fill="#79C99E"/><path d="M20 53c6 5 18 5 24 0 5-4 6-11 2-16-6-7-22-7-28 0-4 5-3 12 2 16Z" fill="#FF9F68"/></svg>
        allergenfreedog
      </div>
    </div>
  </header>

  <main class="container hero">
    <h1><span class="tag">Find likely allergens</span> by comparing foods</h1>
    <p class="lede">List foods that cause reactions on the left and safe foods on the right. We'll highlight suspect ingredients and let you test new foods.</p>

    <form id="compare" class="card">
      <div class="columns">
        <div>
          <h2>Trigger foods</h2>
          <div id="triggerList"></div>
          <button type="button" class="btn ghost" id="addTrigger">+ Add trigger food</button>
        </div>
        <div>
          <h2>Safe foods</h2>
          <div id="safeList"></div>
          <button type="button" class="btn ghost" id="addSafe">+ Add safe food</button>
        </div>
      </div>
      <div style="margin-top:16px">
        <button type="submit" class="btn primary">Compare</button>
      </div>
    </form>

    <section id="results" class="card" hidden>
      <h2>Results</h2>
      <h3>Suspect ingredients</h3>
      <ul id="suspects"></ul>
      <h3>Common ingredients</h3>
      <ul id="commons"></ul>
    </section>

    <section id="tester" class="card" hidden>
      <h2>Test a new food</h2>
      <div class="field">
        <label for="newFood">Ingredients</label>
        <textarea id="newFood" rows="3" placeholder="Chicken, rice, beet pulp…"></textarea>
      </div>
      <button type="button" class="btn primary" id="testFood">Check</button>
      <p id="testResult"></p>
    </section>
  </main>

  <script>
    const MASTER = [
      {name:"wheat", tags:["gluten"], note:"Gluten cereal"},
      {name:"wheat gluten", tags:["gluten"], note:"Gluten protein"},
      {name:"barley", tags:["gluten"], note:"Gluten cereal"},
      {name:"rye", tags:["gluten"], note:"Gluten cereal"},
      {name:"maize", aliases:["corn"], tags:["possible"], note:"Some dogs sensitive"},
      {name:"soya", aliases:["soy"], tags:["possible"], note:"Legume; known allergen for some"},
      {name:"pea", aliases:["yellow peas","pea flour","pea protein"], tags:["possible"], note:"Legume protein"},
      {name:"buckwheat", tags:["possible"], note:"Plant pseudo-grain"},
      {name:"yeast", aliases:["yeast extract","hydrolyzed yeasts","yeast products"], tags:["possible"], note:"Can bother yeast‑sensitive dogs"},
      {name:"salmon", aliases:["salmon oil","hydrolysed salmon protein","hydrolysed salmon gravy"], tags:["possible"], note:"Fish protein/fat"},
      {name:"fish oil", tags:["possible"], note:"Fish source"},
      {name:"poultry", aliases:["dehydrated poultry proteins","poultry digest","poultry fat"], tags:["danger"], note:"Chicken/turkey family"},
      {name:"chicken", tags:["danger"], note:"Poultry"},
      {name:"animal fat", tags:["possible"], note:"May carry trace proteins depending on refinement"},
      {name:"glucosamine", tags:[], note:"Joint support"},
      {name:"hydrolysed animal proteins", tags:["low"], note:"Hydrolysed — reduced allergenicity"},
      {name:"hydrolyzed", tags:["low"], note:"Hydrolysed marker"},
      {name:"insect", tags:[], note:"Novel protein"},
      {name:"algae", aliases:["schizochytrium","ascophyllum"], tags:[], note:"Omega‑3/trace"},
      {name:"coconut oil", tags:[], note:"Fat source"},
      {name:"linseed", tags:[], note:"Omega‑3 plant"},
      {name:"lactobacillus", tags:[], note:"Probiotic"},
      {name:"fructo-oligosaccharides", tags:[], note:"Prebiotic"},
      {name:"beta-glucans", tags:[], note:"Immune/prebiotic"},
      {name:"psyllium", tags:[], note:"Fibre"},
      {name:"beet pulp", tags:[], note:"Fibre"},
      {name:"apple pulp", tags:[], note:"Fibre"},
      {name:"minerals", tags:[], note:"Trace elements"}
    ];

    function stdName(raw){
      let s = raw.toLowerCase().trim();
      s = s.replace(/\(.*?\)/g, '').replace(/\d+%/g,'').replace(/\s+/g,' ').trim();
      for(const m of MASTER){
        const terms = [m.name, ...(m.aliases||[])];
        for(const t of terms){ if(s.includes(t)) return m.name; }
      }
      return s;
    }
    function tagsFor(name){
      const m = MASTER.find(x=>x.name===name);
      return m ? m.tags : [];
    }
    function noteFor(name){
      const m = MASTER.find(x=>x.name===name);
      return m ? m.note : '';
    }
    function parseList(text){
      return text.split(/,|;|\n/).map(x=>x.trim()).filter(Boolean);
    }

    function addField(listId){
      const container = document.getElementById(listId);
      const wrap = document.createElement('div');
      wrap.className = 'field';
      wrap.innerHTML = `<input type="text" class="foodName" placeholder="Food name (optional)">
        <textarea class="foodList" rows="3" placeholder="Ingredients separated by commas"></textarea>`;
      container.append(wrap);
    }
    document.getElementById('addTrigger').addEventListener('click',()=>addField('triggerList'));
    document.getElementById('addSafe').addEventListener('click',()=>addField('safeList'));
    addField('triggerList');
    addField('safeList');

    function collect(listId){
      return Array.from(document.querySelectorAll(`#${listId} .foodList`))
        .map(el=>parseList(el.value))
        .filter(arr=>arr.length);
    }
    function union(groups){
      const set = new Set();
      groups.forEach(list=>{ list.map(stdName).forEach(i=>set.add(i)); });
      return set;
    }
    function renderList(id, arr){
      const ul = document.getElementById(id);
      ul.innerHTML = '';
      arr.forEach(name=>{
        const t = tagsFor(name);
        const cls = t.includes('danger') || t.includes('gluten') ? 'danger' : t.includes('possible') ? 'warn' : 'ok';
        const li = document.createElement('li');
        li.innerHTML = `<span class="pill ${cls}">${cls.toUpperCase()}</span> <strong>${name}</strong> ${noteFor(name)}`;
        ul.append(li);
      });
    }

    let suspectSet = new Set();
    document.getElementById('compare').addEventListener('submit', e=>{
      e.preventDefault();
      const trig = collect('triggerList');
      const safe = collect('safeList');
      if(!trig.length || !safe.length){ alert('Enter at least one food in each column.'); return; }
      const trigSet = union(trig);
      const safeSet = union(safe);
      const suspects = [...trigSet].filter(x=>!safeSet.has(x)).sort();
      const commons = [...trigSet].filter(x=>safeSet.has(x)).sort();
      suspectSet = new Set(suspects);
      renderList('suspects', suspects);
      renderList('commons', commons);
      document.getElementById('results').hidden = false;
      document.getElementById('tester').hidden = false;
    });

    document.getElementById('testFood').addEventListener('click',()=>{
      const ingredients = parseList(document.getElementById('newFood').value).map(stdName);
      const hits = ingredients.filter(x=>suspectSet.has(x));
      const out = document.getElementById('testResult');
      if(!ingredients.length){ out.textContent=''; return; }
      if(hits.length){
        out.innerHTML = `<span class="pill danger">DANGER</span> Contains ${hits.join(', ')}`;
      } else {
        out.innerHTML = `<span class="pill ok">OK</span> No suspect ingredients found`;
      }
    });
  </script>
</body>
</html>
